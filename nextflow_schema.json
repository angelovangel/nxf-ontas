{
  "$schema": "http://json-schema.org/draft-07/schema",
  "$id": "https://raw.githubusercontent.com/angelovangel/nxf-alignment/master/nextflow_schema.json",
  "title": "angelovangel/nxf-alignment",
  "workflow_title": "NXF-ALIGNMENT workflow",
  "description": "Basecall, align, and analyze ONT data",
  "url": "https://github.com/angelovangel/nxf-alignment",
  "type": "object",
  "definitions": {
    "basecalling_options": {
      "title": "Basecalling/Input reads options",
      "type": "object",
      "fa_icon": "fas fa-angle-double-right",
      "description": "Choose basecalling or input reads, adaptive sampling decisions file (optional), kit and samplesheet (for barcoded run).",
      "properties": {
        "pod5": {
          "type": "string",
          "format": "directory-path",
          "fa_icon": "fas fa-folder-open",
          "description": "Directory with POD5 files (use when basecalling)",
          "help_text": "Path to directory containing POD5 files for basecalling. Required when starting from raw data."
        },
        "model": {
          "type": "string",
          "description": "Dorado basecalling model",
          "fa_icon": "fas fa-microchip",
          "default": "fast",
          "help_text": "Name of the Dorado model to use for basecalling. Default is 'fast'. For modifications, use for example 'hac,5mCG_5hmCG'. See [Dorado models](https://software-docs.nanoporetech.com/dorado/latest/models/selection/)."
        },
        "reads": {
          "type": "string",
          "format": "path",
          "fa_icon": "fas fa-file",
          "description": "BAM/FASTQ file or directory of reads (skips basecalling)",
          "help_text": "Path to a single BAM/FASTQ file or directory containing multiple read files. If provided, basecalling will be skipped."
        },
        "asfile": {
          "type": "string",
          "format": "file-path",
          "fa_icon": "fas fa-filter",
          "description": "Adaptive sampling CSV file",
          "help_text": "CSV file from adaptive sampling that filters which reads to basecall."
        },
        "kit": {
          "type": "string",
          "description": "Barcoding kit name",
          "fa_icon": "fas fa-barcode",
          "help_text": "Name of the barcoding kit used. Required when run is barcoded.",
          "enum": [
            "SQK-16S024",
            "SQK-16S114-24",
            "SQK-NBD114-24",
            "SQK-NBD114-96",
            "SQK-PCB114-24",
            "SQK-RBK114-24",
            "SQK-RBK114-96",
            "SQK-RPB114-24",
            "TWIST-16-UDI",
            "TWIST-96A-UDI",
            "VSK-PTC001",
            "VSK-VMK001",
            "VSK-VMK004",
            "VSK-VPS001"
          ]
        },
        "samplesheet": {
          "type": "string",
          "format": "file-path",
          "fa_icon": "fas fa-vials",
          "mimetype": "text/csv",
          "description": "CSV file with sample and barcode information",
          "help_text": "Samplesheet must contain columns 'sample' and 'barcode'. Required when run is barcoded."
        }
      },
      "oneOf": [
        {
          "required": [
            "pod5",
            "model"
          ]
        },
        {
          "required": [
            "reads"
          ]
        }
      ]
    },
    "alignment_options": {
      "title": "Alignment options",
      "type": "object",
      "fa_icon": "fas fa-cogs",
      "description": "Options for alignment.",
      "required": [
        "ref"
      ],
      "properties": {
        "ref": {
          "type": "string",
          "format": "file-path",
          "fa_icon": "fas fa-dna",
          "description": "Reference FASTA file",
          "help_text": "Path to reference FASTA file for alignment. Required unless using -entry basecall."
        },
        "bed": {
          "type": "string",
          "format": "file-path",
          "fa_icon": "fas fa-map",
          "description": "BED file with regions of interest",
          "help_text": "BED file defining regions of interest. If omitted, will be auto-generated from the reference file."
        }
      }
    },
    "other_options": {
      "title": "Other options",
      "type": "object",
      "fa_icon": "fas fa-question-circle",
      "description": "Output and other options.",
      "help_text": "It is recommended to not change the default output directory.",
      "required": [
        "outdir"
      ],
      "properties": {
        "outdir": {
          "type": "string",
          "format": "directory-path",
          "description": "The output directory where the results will be saved",
          "fa_icon": "fas fa-poll",
          "default": "output"
        }
      }
    }
  },
  "allOf": [
    {
      "$ref": "#/definitions/basecalling_options"
    },
    {
      "$ref": "#/definitions/alignment_options"
    },
    {
      "$ref": "#/definitions/other_options"
    }
  ]
}